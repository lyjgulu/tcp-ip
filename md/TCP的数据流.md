## tcp的交互数据流
- 对于交互性要求比较高的应用,TCP 给出两个策略来提高发送效率和减低网络负担：
    - 捎带ACK
    - Nagle算法(一次尽量多 的发数据)
### 1、捎带ACK的发送方式
- 这个策略是说,当主机收到远程主机的 TCP 数据报之后,通常不马上发送 ACK 数据报,而是等上一个短暂的时间,如果这段时 间里面主机还有发送到远程 主机的 TCP 数据报,那么就把这个 ACK 数据报“捎带”着发送出去,把本来两个 TCP 数据报整合成一个发 送。一般的,这个时间是200ms。可以明显地看 到这个策略可以把 TCP 数据报的利用率提高很多。
### 2、Nagle算法
- 当主机 A 给主机 B 发送了一个 TCP 数据报并进入等待主机 B 的 ACK 数据报的状态时,TCP 的输出缓冲区里面 只能有一个 TCP 数 据报,并且,这个数据报不断地收集后来的数据,整合成一个大的数据报,等到 B 主机的 ACK 包一到,就把这些 数据“一股脑”的发送出去。
## tcp的成块数据流
### 1、传输数据时 ACK 的问题
- ACK 的应答策略,一般来说,发送端发送一个 TCP 数据报,那么接收端就应该发送一个 ACK 数 据报。但是事实上却不是这 样,发送端将会连续发送数据尽量填满接受方的缓冲区,而接受方对这些数据只要发送一个 ACK 报文来 回应就可以了,这就是 ACK 的累积特性,这个特性大大减 少了发送端和接收端的负担。
### 2、滑动窗口
- 滑动窗口本质上是描述接受方的 TCP 数据报缓冲区大小的数据,发送方根据这个数据来计算自己最多能发送多长的数据。如果发送方收到接受方的窗口大小为0的 TCP 数据报,那么发送方将停止发送数据,等到接受方发送窗口大小不为0的数据报的到来。
- 滑动窗口协议三个术语：
    - 窗口合拢: 当窗口从左边向右边靠近的时候,这种现象发生在数据被发送和确认的时候。
    - 窗口张开: 当窗口的右边沿向右边移动的时候,这种现象发生在接受端处理了数据以后。
    - 窗口收缩: 当窗口的右边沿向左边移动的时候,这种现象不常发生。
- TCP 用这个窗口,慢慢的从数据的左边移动到右边,把处于窗口范围内的数据发送出去
### 3、数据拥塞
- 拥塞窗口原理：TCP 发送方首先发送一个数据报,然后等待对方的回应,得到回应后就把这个窗口的大小加倍,然后连 续发送两个数据报,等到对 方回应以后,再把这个窗口加倍(先是2的指数倍,到一定程度后就变成现行增长,这就是所谓的慢启动), 发送更多的数据报,直到出现超时错误,这样,发送端 就了解到了通信双方的线路承载能力,也就确定了拥塞窗口的大小,发送方就 用这个拥塞窗口的大小发送数据。（下载速度慢慢增长）